id: CVE-2008-1547

info:
  name: Microsoft OWA Exchange Server 2003 - 'redir.asp' Open Redirection
  author: ctflearner
  severity: medium
  description: |
    Open redirect vulnerability in exchweb/bin/redir.asp in Microsoft Outlook Web Access (OWA) for Exchange Server 2003 SP2 (aka build 6.5.7638) allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via a URL in the URL parameter.
  impact: |
    An attacker can exploit this vulnerability to trick users into visiting malicious websites, leading to potential phishing attacks.
  remediation: |
    Apply the necessary security patches or upgrade to a newer version of Microsoft Exchange Server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2008-1547
    - https://www.exploit-db.com/exploits/32489
    - http://securityreason.com/securityalert/4441
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/46061
    - https://github.com/tr3ss/newclei
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2008-1547
    cwe-id: CWE-601
    epss-score: 0.03875
    epss-percentile: 0.9108
    cpe: cpe:2.3:a:microsoft:exchange_server:2003:sp2:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: microsoft
    product: exchange_server
    shodan-query:
      - http.title:"Outlook"
      - http.favicon.hash:1768726119
      - http.title:"outlook"
      - cpe:"cpe:2.3:a:microsoft:exchange_server"
    fofa-query:
      - title="outlook"
      - icon_hash=1768726119
    google-query: intitle:"outlook"
  tags: cve2008,cve,redirect,owa,exchange,microsoft

http:
  - method: GET
    path:
      - "{{BaseURL}}/exchweb/bin/redir.asp?URL=https://interact.sh"
      - "{{BaseURL}}/CookieAuth.dll?GetLogon?url=%2Fexchweb%2Fbin%2Fredir.asp%3FURL%3Dhttps%3A%2F%2Finteract.sh&reason=0"

    stop-at-first-match: true
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'
# digest: 4b0a00483046022100adb698e8a7df0b652e70fc7ce8dee9cd47911b4491e600b4315c4fc54d7e35290221008a66a93ed217d258e21cbd4121243d454487a5284fab8a50e16829c4916d71f7:922c64590222798bb761d5b6d8e72950