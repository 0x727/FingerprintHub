id: java-object
info:
  name: 'BlackBerry Enterprise Service JNDI; URL: $1'
  author: nmap,cn-kali-team
  tags: detect,tech,java-object,service
  severity: info
  metadata:
    hostname: $2
    product: blackberry_enterprise_service
    rarity: 0
    vendor: blackberry
    verified: true
tcp:
- name: 'null'
  inputs:
  - data: ''
  host:
  - '{{Hostname}}'
  extractors:
  - name: java-object
    type: regex
    regex:
    - ^\xac\xed\x00\x05sr\x00\x19java\.rmi\.MarshalledObject\x7c\xbd\x1e\x97\xedc\xfc>\x02\x00\x03I\x00\x04hash\[\x00\x08locBytest\x00\x02\[B\[\x00\x08objBytesq\x00~\x00\x01xp\x16\xa1\xfe\x03ur\x00\x02\[B\xac\xf3\x17\xf8\x06\x08T\xe0\x02\x00\x00xp\x00\x00\x00J\xac\xed\x00\x05t\x00 (http://[\w._-]+:\d+/)q\x00~\x00\x00q\x00~\x00\x00q\x00~\x00\x00q\x00~\x00\x00q\x00~\x00\x00q\x00~\x00\x00q\x00~\x00\x00uq\x00~\x00\x03\x00\x00\x03\x14\xac\xed\x00\x05s}\x00\x00\x00\x02\x00\x19org\.jnp\.interfaces\.Naming\x00,org\.jboss\.ha\.framework\.interfaces\.HARMIProxyxr\x00\x17java\.lang\.reflect\.Proxy\xe1'\xda \xcc\x10C\xcb\x02\x00\x01L\x00\x01ht\x00%Ljava/lang/reflect/InvocationHandler;xpsr\x00-org\.jboss\.ha\.framework\.interfaces\.HARMIClient\xee\xf5\xebj\xfb\xb5\xd9\x91\x03\x00\x03L\x00\x11familyClusterInfot\x00\x35Lorg/jboss/ha/framework/interfaces/FamilyClusterInfo;L\x00\x03keyt\x00\x12Ljava/lang/String;L\x00\x11loadBalancePolicyt\x00\x35Lorg/jboss/ha/framework/interfaces/LoadBalancePolicy;xpw%\x00#RIM_BES_BAS_HA_338625_VCBES1/HAJNDIsr\x00\x13java\.util\.ArrayListx\x81\xd2\x1d\x99\xc7a\x9d\x03\x00\x01I\x00\x04sizexp\x00\x00\x00\x01w\x04\x00\x00\x00\x01sr\x00\x32org\.jboss\.ha\.framework\.server\.HARMIServerImpl_Stub\x00\x00\x00\x00\x00\x00\x00\x02\x02\x00\x00xr\x00\x1ajava\.rmi\.server\.RemoteStub\xe9\xfe\xdc\xc9\x8b\xe1e\x1a\x02\x00\x00xr\x00\x1cjava\.rmi\.server\.RemoteObject\xd3a\xb4\x91\x0ca3\x1e\x03\x00\x00xpw\x3d\x00\x0bUnicastRef2\x00\x00.([\w._-]+)\x00\x00\xc0\x81k\x9b\n;\x12\xdb\$\x89\t\xc3\x15G\x00
