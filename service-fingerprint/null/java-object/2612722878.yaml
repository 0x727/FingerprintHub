id: java-object
info:
  name: NE3S Naming Service
  author: nmap,cn-kali-team
  tags: detect,tech,java-object,service
  severity: info
  metadata:
    hostname: $1
    rarity: 0
tcp:
- name: 'null'
  inputs:
  - data: ''
  host:
  - '{{Hostname}}'
  extractors:
  - name: java-object
    type: regex
    regex:
    - ^\xac\xed\x00\x05sr\x00\x19java\.rmi\.MarshalledObject\x7c\xbd\x1e\x97\xedc\xfc>\x02\x00\x03I\x00\x04hash\[\x00\x08locBytest\x00\x02\[B\[\x00\x08objBytesq\x00~\x00\x01xpsN\x96Rur\x00\x02\[B\xac\xf3\x17\xf8\x06\x08T\xe0\x02\x00\x00xp\x00\x00\x00\)\xac\xed\x00\x05t..http://([\w._-]+):\d+q\x00~\x00\x00q\x00~\x00\x00uq\x00~\x00\x03\x00\x00\x00\xc2\xac\xed\x00\x05sr\x00 org\.jnp\.server\.NamingServer_Stub\x00\x00\x00\x00\x00\x00\x00\x02\x02\x00\x00xr\x00\x1ajava\.rmi\.server\.RemoteStub\xe9\xfe\xdc\xc9\x8b\xe1e\x1a\x02\x00\x00xr\x00\x1cjava\.rmi\.server\.RemoteObject\xd3a\xb4\x91\x0ca3\x1e\x03\x00\x00xpw6\x00\x0bUnicastRef2\x00..[\d.]+\x00\x00FRS\xf5\x7f\[<\xda\xbd\x92\xcfN\x8c\xcf\x00\x00\x01Ay\x1e\xc1\xba\x80\x01\x00x
