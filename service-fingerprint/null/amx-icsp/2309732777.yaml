id: amx-icsp
info:
  name: AMX ICSP
  author: nmap,cn-kali-team
  tags: detect,tech,amx-icsp,service
  severity: info
  metadata:
    info: VxWorks image $2; boot ROM $3; AXLink I/F uController $4
    operating_system: VxWorks
    rarity: 0
    version: $1
tcp:
- name: 'null'
  inputs:
  - data: ''
  host:
  - '{{Hostname}}'
  extractors:
  - name: amx-icsp
    type: regex
    regex:
    - ^\x02\x00\]\x02\x00\x00\x00\x00\x00\x00\x01\x00.\x00\x00\x00\x01\x0f\xff\x81\x00\x97\x00\x00\x00.\x00\x04\x00\x00\x00\x01\x01\+\d+x\d+\x00\x00\x01\|v([\d.]+)\x00NI Master\x00AMX Corp\.\x00\x06\x0c\xc0\xa8\"D\x05'\x00`\x9f....\x02\x00U\x02\x00\x00\x00\x00\x00\x00\x01\x00.\x00\x00\x00\x01\x0f\xff\x82\x00\x97\x00\x00\x00.\x00\x04\x01\x00\x00\x01\x01\+N/A             \x01zv([\d.]+)\x00vxWorks Image\x00AMX Corp\.\x00\x00\x00.\x02\x00O\x02\x00\x00\x00\x00\x00\x00\x01\x00.\x00\x00\x00\x01\x0f\xff\x83\x00\x97\x00\x00\x00.\x00\x04\x02\x00\x00\x01\x01\+N/A             \x01{v([\d.]+)\x00BootROM\x00AMX Corp\.\x00\x00\x00.\x02\x00\^\x02\x00\x00\x00\x00\x00\x00\x01\x00.\x00\x00\x00\x01\x0f\xff\x84\x00\x97\x00\x00\x00.\x00\x04\x03\x00\x00\x01\x01\x000000000000000000\x01\x0ev([\d.]+)\x00AXLink I/F uController  \x00AMX Corp\.\x00\x03\x00.$
