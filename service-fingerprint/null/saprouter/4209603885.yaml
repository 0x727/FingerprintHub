id: saprouter
info:
  name: SAProuter
  author: nmap,cn-kali-team
  tags: detect,tech,saprouter,service
  severity: info
  metadata:
    hostname: $3
    info: 'local time: $1'
    product: network_interface_router
    rarity: 0
    vendor: sap
    verified: true
    version: $2
tcp:
- name: 'null'
  inputs:
  - data: ''
  host:
  - '{{Hostname}}'
  extractors:
  - name: saprouter
    type: regex
    regex:
    - '(?i)^\x00\x00\x00.NI_RTERR\x00.\x00\x00\xff\xff\xff\xfb\x00\x00\x00.\*ERR\*\x001\x00connection timed out\x00-5\x00NI \(network interface\)\x00\d+\x00\d+\x00nirout\.cpp\x00\d+\x00RTPENDLIST::timeoutPend: no route received within 5s \(CONNECTED\)\x00([^\x00]+)\x00\x00\x00\x00\d+\x00SAProuter ([\d.]+) on ''([\w._-]+)''\x00\x00\x00\x00\x00\*ERR\*\x00\x00\x00\x00\x00'
