id: printer
info:
  name: NetSarang Xlpd
  author: nmap,cn-kali-team
  tags: detect,tech,printer,service
  severity: info
  metadata:
    hostname: $1
    info: HP LaserJet $2; Status $3
    operating_system: Windows
tcp:
- name: terminal-server
  inputs:
  - data: \x03\0\0\x0b\x06\xe0\0\0\0\0\0
  host:
  - '{{Hostname}}'
  extractors:
  - name: printer
    type: regex
    regex:
    - '^Host Name: ([-\w_.]+)\nPrinter Device: hp LaserJet (\w+)\nPrinter Status: ([^\r\n]+)\n\0\0'
