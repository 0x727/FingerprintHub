id: minecraft
info:
  name: Minecraft game server
  author: nmap,cn-kali-team
  tags: detect,tech,minecraft,service
  severity: info
  metadata:
    product: minecraft
    rarity: 6
    vendor: minecraft
    verified: true
tcp:
- name: terminal-server
  inputs:
  - data: \x03\0\0\x0b\x06\xe0\0\0\0\0\0
  host:
  - '{{Hostname}}'
  port: 515,1028,1068,1503,1720,1935,2040,3388,3389
  extractors:
  - name: minecraft
    type: regex
    regex:
    - '^\xf3\x01\x1a\xf0\x01\{"translate":"disconnect\.genericReason","with":\["Internal Exception: io\.netty\.handler\.codec\.DecoderException: java\.lang\.IndexOutOfBoundsException: readerIndex: (?:45|14), writerIndex: 3 \(expected: 0 <= readerIndex <= writerIndex <= capacity\(3\)\)"\]\}'
