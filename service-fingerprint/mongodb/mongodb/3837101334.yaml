id: mongodb
info:
  name: MongoDB
  author: nmap,cn-kali-team
  tags: detect,tech,mongodb,service
  severity: info
  metadata:
    info: auth required
    product: mongodb
    rarity: 8
    vendor: mongodb
    verified: true
tcp:
- name: mongodb
  inputs:
  - data: \x41\0\0\0\x3a\x30\0\0\xff\xff\xff\xff\xd4\x07\0\0\0\0\0\0test.$cmd\0\0\0\0\0\xff\xff\xff\xff\x1b\0\0\0\x01serverStatus\0\0\0\0\0\0\0\xf0\x3f\0
  host:
  - '{{Hostname}}'
  port: 9001,27017,49153
  extractors:
  - name: mongodb
    type: regex
    regex:
    - (?i)^..\x00\x00....:0\x00\x00\x01\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\xec\x00\x00\x00\x11operationTime\x00........\x01ok\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02errmsg\x00-\x00\x00\x00command serverStatus requires authentication\x00\x10code\x00\r\x00\x00\x00\x02codeName\x00\r\x00\x00\x00Unauthorized\x00\x03\$clusterTime\x00X\x00\x00\x00\x11clusterTime\x00........\x03signature\x003\x00\x00\x00\x05hash\x00\x14\x00\x00\x00\x00....................\x12keyId\x00........\x00\x00\x00
