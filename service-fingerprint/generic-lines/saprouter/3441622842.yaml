id: saprouter
info:
  name: SAProuter
  author: nmap,cn-kali-team
  tags: detect,tech,saprouter,service
  severity: info
  metadata:
    hostname: $4
    info: 'local time: $1'
    version: $2 SP$3
tcp:
- name: generic-lines
  inputs:
  - data: \r\n\r\n
  host:
  - '{{Hostname}}'
  extractors:
  - name: saprouter
    type: regex
    regex:
    - '^\0\0\0.NI_RTERR\0.\0\0\xff\xff\xff\xa3\0\0\0.\*ERR\*\x001\0Network packet too big\0-93\0NI \(network interface\)\x00\d+\x00\d+\0nibuf\.cpp\x00\d+\0NiBufIIn: message length 218762506 exceeds max \(10024\)\0([^\0]*)\0\0\0\x00\d+\0SAProuter ([\d.]+) \(SP(\d+)\) on ''([^'']+)''\0\0\0\0\0\*ERR\*\0\0\0\0\0'
