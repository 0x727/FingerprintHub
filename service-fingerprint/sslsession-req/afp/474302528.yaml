id: afp
info:
  name: Apple AFP
  author: nmap,cn-kali-team
  tags: detect,tech,afp,service
  severity: info
  metadata:
    info: 'name: $1; protocol 3.4; OS X 10.8; $2'
    operating_system: OS X
tcp:
- name: sslsession-req
  inputs:
  - data: \x16\x03\0\0S\x01\0\0O\x03\0?G\xd7\xf7\xba,\xee\xea\xb2`~\xf3\0\xfd\x82{\xb9\xd5\x96\xc8w\x9b\xe6\xc4\xdb<=\xdbo\xef\x10n\0\0(\0\x16\0\x13\0\x0a\0f\0\x05\0\x04\0e\0d\0c\0b\0a\0`\0\x15\0\x12\0\x09\0\x14\0\x11\0\x08\0\x06\0\x03\x01\0
  host:
  - '{{Hostname}}'
  extractors:
  - name: afp
    type: regex
    regex:
    - (?i)^\x01\x03\0\0........\0\0\0\0........\x9f\xfb.([^\0\x01]+)[\0\x01].*?(i?Mac(?:mini|Pro|Book(?:Air|Pro)?)?\d+,\d+)\x05\x06AFP3\.4\x06AFP3\.3\x06AFP3\.2\x06AFP3\.1\x06AFPX03\x05\tDHCAST128\x04DHX2\x06Recon1\x03GSS\x0fNo User Authent
