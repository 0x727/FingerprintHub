id: apple-iphoto
info:
  name: Apple iPhoto
  author: nmap,cn-kali-team
  tags: detect,tech,apple-iphoto,service
  severity: info
  metadata:
    info: 'Library name: $2'
    product: iphoto
    rarity: 8
    vendor: apple
    verified: true
    version: $1
tcp:
- name: apple-iphoto
  inputs:
  - data: 'GET /server-info HTTP/1.1\r\nClient-DPAP-Version: 1.1\r\nUser-Agent: iPhoto/9.1.1  (Macintosh; N; PPC)\r\n\r\n'
  host:
  - '{{Hostname}}'
  port: '8770'
  extractors:
  - name: apple-iphoto
    type: regex
    regex:
    - '^HTTP/1\.1 200 OK\r\nDate: .*\r\nDPAP-Server: iPhoto/(.*)\r\nContent-Type: application/x-dmap-tagged\r\nContent-Length: \d+\r\n\r\nmsrv\x00\x00\x00\x83mstt\x00\x00\x00\x04\x00\x00\x00\xc8mpro\x00\x00\x00\x04\x00\x02\x00\x00ppro\x00\x00\x00\x04\x00\x01\x00\x01minm\x00\x00\x00.(.*)mslr\x00\x00\x00\x01\x00mstm\x00\x00\x00\x04\x00\x00\x07\x08msal\x00\x00\x00\x01\x00msau\x00\x00\x00\x01\x02msas\x00\x00\x00\x01\x03msix\x00\x00\x00\x01\x00msdc\x00\x00\x00\x04\x00\x00\x00\x01$'
