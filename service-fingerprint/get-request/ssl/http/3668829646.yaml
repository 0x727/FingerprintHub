id: ssl/http
info:
  name: Apache httpd
  author: nmap,cn-kali-team
  tags: detect,tech,ssl/http,service
  severity: info
  metadata:
    hostname: $3
    info: $2; SSL-only mode
    version: $1
tcp:
- name: get-request
  inputs:
  - data: GET / HTTP/1.0\r\n\r\n
  host:
  - '{{Hostname}}'
  extractors:
  - name: ssl/http
    type: regex
    regex:
    - '(?i)^<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2\.0//EN\">\n<html><head>\n<title>400 Bad Request</title>\n</head><body>\n<h1>Bad Request</h1>\n<p>Your browser sent a request that this server could not understand\.<br />\nReason: You''re speaking plain HTTP to an SSL-enabled server port\.<br />\n.*<address>Apache/([\w._-]+) (.*) Server at ([\w._*-]+) Port \d+</address>'
