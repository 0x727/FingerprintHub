id: http
info:
  name: AudioCodes Mediant 200 VoIP gateway http config
  author: nmap,cn-kali-team
  tags: detect,tech,http,service
  severity: info
  metadata:
    device_type: VoIP adapter
tcp:
- name: get-request
  inputs:
  - data: GET / HTTP/1.0\r\n\r\n
  host:
  - '{{Hostname}}'
  extractors:
  - name: http
    type: regex
    regex:
    - '(?i)^HTTP/1\.1 403 Forbidden\r\n(?:[^\r\n]+\r\n)*?Server: Allegro-Software-RomPager/([\d.]+)\r\n.*Correct authorization is required for this area\. Either your browser does not perform authorization, or your authorization has failed\. RomPager server by Digest Access Authentication, which is not supported by your browser\.<P>\nReturn to <A HREF=\"\">last page</A><P>\n\n</BODY>\n</HTML>\n$'
