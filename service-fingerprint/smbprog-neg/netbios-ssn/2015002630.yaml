id: netbios-ssn
info:
  name: Samba smbd
  author: nmap,cn-kali-team
  tags: detect,tech,netbios-ssn,service
  severity: info
  metadata:
    hostname: $P(2)
    info: 'workgroup: $P(1)'
    version: 3.X - 4.X
tcp:
- name: smbprog-neg
  inputs:
  - data: \0\0\0\xa4\xff\x53\x4d\x42\x72\0\0\0\0\x08\x01\x40\0\0\0\0\0\0\0\0\0\0\0\0\0\0\x40\x06\0\0\x01\0\0\x81\0\x02PC NETWORK PROGRAM 1.0\0\x02MICROSOFT NETWORKS 1.03\0\x02MICROSOFT NETWORKS 3.0\0\x02LANMAN1.0\0\x02LM1.2X002\0\x02Samba\0\x02NT LANMAN 1.0\0\x02NT LM 0.12\0
  host:
  - '{{Hostname}}'
  extractors:
  - name: netbios-ssn
    type: regex
    regex:
    - (?i)^\0\0\0.\xffSMBr\0\0\0\0\x88..\0\0[-\w. ]*\0+@\x06\0\0\x01\0\x11\x06\0.{42}(.*)\0\0(.*)\0\0$
